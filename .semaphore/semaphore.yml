version: v1.0
name: Tests
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu2004
blocks:
  - name: 'Test all PHP versions'
    task:
      jobs:
        - name: 'PHP Version'
          matrix:
            - env_var: PHP_VERSION
              values: [ "7.1.33", "7.2.34", "7.3.33", "7.4.33", "8.0.28", "8.1.17", "8.2.4" ]
          commands:
            - checkout
            - phpbrew use $PHP_VERSION
            - cache restore
            - composer install --no-progress --no-suggest --prefer-dist -o
            - cache store
            - ./vendor/bin/phpunit test
